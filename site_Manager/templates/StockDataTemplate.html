{% extends "baseStructureSM.html" %}
{% load static %}
{% block title %}Banner{% endblock %}
{% block subtitle %}Homepage Banner{% endblock %}

{% block SMprofile_content %}
<style>
  .user-portfolio-toptable1 td {
        padding: 8px;
        border: 1px solid #ddd;
        vertical-align: top;
        word-wrap: break-word;
        overflow-wrap: anywhere;
        white-space: normal;
    }
    .user-portfolio-toptable1 td:nth-child(1) { width: 30%; }
    .user-portfolio-toptable1 td:nth-child(2) { width: 20%; } 
    .user-portfolio-toptable1 td:nth-child(3) { width: 20%; } 
    .user-portfolio-toptable1 td:nth-child(4) { width: 10%; } 
    .user-portfolio-toptable1 td:nth-child(5) { width: 10%; }
    .user-portfolio-toptable1 td:nth-child(5) { width: 10%; }
</style>
<div class="user-portfolio-top">
  <div class="user-dashboard-heading"><h3>StockDate</h3></div>
</div>
<div class="user-portfolio-top">
<form method="get" class="row g-3 mb-3" style="padding:0 10px;">
  <div class="col-md-3">
    <input type="text" name="search" class="form-control" placeholder="Search by Company / Scrip / ISIN" value="{{ filters.search_query }}">
  </div>

  <div class="col-md-2">
    <select name="sector" class="form-select">
      <option value="">All Sectors</option>
      {% for sector in sectors %}
        <option value="{{ sector }}" {% if filters.sector == sector %}selected{% endif %}>{{ sector }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2">
    <select name="category" class="form-select">
      <option value="">All Categories</option>
      {% for category in categories %}
        <option value="{{ category }}" {% if filters.category == category %}selected{% endif %}>{{ category }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2">
    <select name="conviction_level" class="form-select">
      <option value="">All Conviction Levels</option>
      {% for cl in conviction_levels %}
        <option value="{{ cl }}" {% if filters.conviction_level == cl %}selected{% endif %}>{{ cl }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-2">
    <select name="stock_type" class="form-select">
      <option value="">All Stock Types</option>
      {% for st in stock_types %}
        <option value="{{ st }}" {% if filters.stock_type == st %}selected{% endif %}>{{ st }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-1">
    <button type="submit" class="btn btn-primary w-100">Filter</button>
  </div>
</form>
</div>
<div class="SMtable-head">
<div class="SMtable-scroll-container">
  <table class="user-portfolio-toptable1">
    <thead class="user-portfolio-head-admin">
      <tr>
          <th>Company</th>
          <th>Scrip</th>
          <th>Sector</th>
          <th>Conviction</th>
          <th>Share Price</th>
          <th>Actions</th>
      </tr>
    </thead>
    <tbody>
        {% for stock in stocks %}
            <tr>
                <td>{{ stock.company_name }}</td>
                <td>{{ stock.scrip_name }}</td>
                <td>{{ stock.sector }}</td>
                <td>{{ stock.conviction_level }}</td>
                <td>{{ stock.share_price }}</td>
                <td>
                    <a href="{% url 'SM_User:edit_stockdata' stock.pk %}" class="btn btn-sm btn-warning">Edit</a>
                    <!-- <a href="#" class="btn btn-sm btn-danger">Delete</a> -->
                </td>
            </tr>
        {% empty %}
            <tr><td colspan="6" class="text-center">No matching stocks found.</td></tr>
        {% endfor %}
    </tbody>
</table>
</div>
</div>
{% endblock %}
