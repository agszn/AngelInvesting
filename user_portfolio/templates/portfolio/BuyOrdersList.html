{% extends "accounts/profile.html" %}
{% block title %}My Profile{% endblock %}

{% block profile_content %}
<div class="user-porfolio-dashboard">
    <div class="user-portfolio-top">
        <div class="user-dashboard-heading"><h3>Buy Order Summary</h3></div>
        <div class="search-details-user">
          <form method="get">
            <input type="text" name="search" placeholder="Search or type command..." value="{{ search_query }}">
            <button type="submit" style="margin-left: 10px; margin-right: 50px; padding: 8px 12px; border: none; background-color: #1a3e6e; color: white; border-radius: 5px;">Search</button>
          </form>
        </div>
    </div>
    <div style="overflow-x: auto;">
<div style="min-width: 800px;">
    <div class="user-portfolio-table">
      <table class="user-portfolio-toptable">
        <thead class="user-portfolio-head1">
          <tr>
            <th>Stock Name</th>
            <th>Advisor</th>
            <th>Broker</th>
            <th>Quantity</th>
            <th>Buy Price</th>
            <th>Total Amt</th>
            <th>Order Type</th>
            <th>Status</th>
            <!-- <th>Type</th> -->
          </tr>
        </thead>
        <tbody>
          {% for order in page_obj %}
            <tr style="background: {% cycle '#f5f9ff' 'white' %};">
              <td>{{ order.stock.company_name }}</td>
              <td>{{ order.advisor.advisor_type|default:"Others" }}</td>
              <td>{{ order.broker.name|default:"N/A" }}</td>
              <td>{{ order.quantity }}</td>
              <td>₹{{ order.price_per_share }}</td>
              <td>₹{{ order.total_amount }}</td>
              <td>{{ order.order_type|title }}</td>
              <td style="color:
                {% if order.status == 'Completed' %}green
                {% elif order.status == 'Processing' %}orange
                {% elif order.status == 'Cancel' %}red
                {% else %}#cc6600{% endif %};">
                {{ order.status }}
              </td>
              <!-- <td style="padding: 10px; font-weight: bold; color: {% if order.is_other %}#ff6600{% else %}#0077cc{% endif %};">
                {% if order.is_other %}Other Advisor{% else %}Buy{% endif %}
              </td> -->
            </tr>
          {% empty %}
            <tr><td colspan="9" style="text-align: center; padding: 15px;">No buy orders found.</td></tr>
          {% endfor %}
        </tbody>
      </table>


      <!-- Pagination -->
      <div class="user-portfolio-tpaginatioin">
        {% if page_obj.has_previous %}
          <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}">&laquo; First</a>
          <a href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">Previous</a>
        {% endif %}

        <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}">Next</a>
          <a href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}">Last &raquo;</a>
        {% endif %}
      </div>
    </div>
    </div>
    </div>
</div>
{% endblock %}
