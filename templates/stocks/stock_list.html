{% extends 'base.html' %}
<!-- templates/stocks/stock_list.html -->
{% block title %}Stock Details{% endblock %}
{% load custom_filters %}
{% block content %}
{% load static %}  
<style>
   .stock-card-image {
              width: 100%;
              height: 100%;
              object-fit: contain;
              border-radius: 6px;
          }
  .wishlist-modal {
    display: none; 
    position: fixed; 
    z-index: 1000; 
    left: 0;
    top: 0;
    width: 100%; 
    height: 100%; 
    overflow: auto; 
    background-color: rgba(0,0,0,0.6); /* Overlay */
  }

  .wishlist-modal-content {
    background-color: #c2cbde;
    margin: 10% auto; 
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 400px;
    border-radius: 10px;
    text-align: center;
    animation: fadeIn 0.3s ease;
  }

  .wishlist-modal .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  .wishlist-modal .close:hover,
  .wishlist-modal .close:focus {
    color: black;
    text-decoration: none;
  }

  @keyframes fadeIn {
    from {opacity: 0;}
    to {opacity: 1;}
  }

@media (min-width: 320px) and (max-width: 767px) {

}
</style>  

<section class="unlisted-share-section" style="margin-top: 50px;">
  <div class="hero-headers">
    <h1 class="heading">Explore <span class="highlight">Unlisted Shares</span></h1>
  </div>

  <!-- templates/stocks/stock_list.html -->
  <div class="search-bar-wrapper" style="position: relative;">
    <form method="GET">
      <input id="searchInput" class="search-bar-input" type="text" name="q" placeholder="Search here..." value="{{ query }}" autocomplete="off">
      <button class="search-bar-button" type="submit">SEARCH</button>
    </form>
  </div>

  <div class="unlisted-share-boxex" id="stock-cards">
    {% include "stocks/partials/stock_cards.html" %}
  </div>

  <div>
    <div class="viewall3" style="margin-top: 40px;">
      <button class="viewallbtn3">
        <a style="color: black; text-decoration: none;" href="{% url 'unlisted_stock_marketplace:StockListingTableFormat' %}">View All Listings</a>
      </button>
    </div>
  </div>
</section>



<script>
  document.addEventListener('DOMContentLoaded', function () {
      const input = document.getElementById('searchInput');
      const suggestionsBox = document.getElementById('suggestions');

      input.addEventListener('input', function () {
          const query = this.value;
          if (query.length === 0) {
              suggestionsBox.style.display = 'none';
              return;
          }

          fetch(`/stocks/suggestions/?q=${encodeURIComponent(query)}`)
              .then(response => response.json())
              .then(data => {
                  suggestionsBox.innerHTML = '';
                  if (data.length === 0) {
                      suggestionsBox.style.display = 'none';
                      return;
                  }

                  data.forEach(stock => {
                      const div = document.createElement('div');
                      div.textContent = stock.company_name;
                      div.onclick = function () {
                          input.value = stock.company_name;
                          suggestionsBox.style.display = 'none';
                      };
                      suggestionsBox.appendChild(div);
                  });
                  suggestionsBox.style.display = 'block';
              });
      });

      document.addEventListener('click', function (e) {
          if (!document.querySelector('.search-bar-wrapper').contains(e.target)) {
              suggestionsBox.style.display = 'none';
          }
      });
  });
</script>
{% endblock %}  